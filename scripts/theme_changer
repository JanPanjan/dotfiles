#!/usr/bin/env bash

term_config="$HOME/.config/alacritty/alacritty.toml"
sway_config="$HOME/.config/sway"

select_theme(){
    echo -e "dark\nlight" | wofi -p "Select theme" --show dmenu
}

chosen=$(select_theme) || exit 1

echo "Changing to $chosen theme"

# change bar, workspace and client colors
[[ -e "$sway_config/config" ]] && \
    sed -i -e "s#theme/.*#theme/$chosen#" "$sway_config/config"  && \
    swaymsg reload

# change lockscreen
[[ -e "$sway_config/general/misc" ]] && \
    sed -i -e "s#lockscreen-.*\.png#lockscreen-$chosen\.png#" "$sway_config/general/misc"

# change wallpaper
if [[ "dark" == $chosen ]]; then
    pkill swaybg && swaybg -i ~/.config/sway/wp/story.png -m fill &
else
    pkill swaybg && swaybg -i ~/.config/sway/wp/story-negative.png -m fill &
fi

echo "Sway config updated."

if [[ -e "$term_config" ]]; then
    # switch toml files
    sed -i -e "s/\"[^\"]*\.toml\"/\"$chosen.toml\"/" "$term_config"
fi

echo "Alacritty config updated."
echo "Theme changed."

exit 0
